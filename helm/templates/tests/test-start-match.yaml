apiVersion: v1
kind: Pod
metadata:
  name: "{{ .Release.Name }}-start-match-test"
  annotations:
    "helm.sh/hook": test
spec:
  containers:
    - name: {{ .Release.Name }}-start-match-test
      image: {{ .Values.js.image.repository }}
      imagePullPolicy: {{ .Values.js.image.pullPolicy | quote }}
      env:
        - name: NAKAMA_HOST
          value: "niwrad"
        - name: NAKAMA_PORT
          value: "7350"
        - name: USERNAME
          value: {{ .Values.nakama.default.username | quote }}
        - name: PASSWORD
          value: {{ .Values.nakama.default.password | quote }}
      command:
        - /bin/bash
        - -ec
        - |
          npm test
  restartPolicy: Never